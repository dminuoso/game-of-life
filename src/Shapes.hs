{-# LANGUAGE GADTs, FlexibleContexts #-}
module Shapes where

-- Extra
import Control.Comonad.Store (Store, store, peek)
import Control.Lens (ix, non, (^?), (^.), to)

-- Project
import Pos

shape :: [String] -> Store Pos Bool
shape text = store (peek text) (V2 0 0) where
    peek :: [String] -> Pos -> Bool
    peek text (V2 x y) = (text ^? ix x . ix y . to (=='x')) ^. non False

toad :: Store Pos Bool
toad =  shape [ "......"
              , ".xx..."
              , ".xx..."
              , "...xx."
              , "...xx."
              , "......"
              ]

pentadecathlon :: Store Pos Bool
pentadecathlon = shape [ "................................."
                       , "................................."
                       , "................................."
                       , "................................."
                       , "................................."
                       , "................................."
                       , "..............x....x............."
                       , "............xx.xxxx.xx..........."
                       , "..............x....x............."
                       , "................................."
                       , "................................."
                       , "................................."
                       , "................................."
                       , "................................."
                       ]

gun :: Store Pos Bool
gun = shape
    [ "......................................."
    , "......................................."
    , "......................................."
    , "..........................x............"
    , "........................x.x............"
    , "..............xx......xx............xx."
    , ".............x...x....xx............xx."
    , "..xx........x.....x...xx..............."
    , "..xx........x...x.xx....x.x............"
    , "............x.....x.......x............"
    , ".............x...x....................."
    , "..............xx......................."
    , "......................................."
    ]
gPos :: Pos
gPos = V2 10 33
